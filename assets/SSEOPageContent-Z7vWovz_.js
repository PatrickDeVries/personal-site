import{i as H,k as A,s as _,a as h,T as q,g as w,m as M,r as P,j as d,n as V,o as U,f as J,b as B,B as E,I as G}from"./index-maD79-Qe.js";const O=new WeakMap,I=new WeakMap,Q=(e,t)=>{const r=O.get(e);r&&(r[0].forEach(i=>{const{d:l}=i;e!==l&&Q(l)}),++r[2],t&&r[3].add(t))},D=e=>{const t=O.get(e);t&&(--t[2],t[2]||(t[3].forEach(r=>r()),t[3].clear()),t[0].forEach(r=>{const{d:i}=r;e!==i&&D(i)}))},X=e=>{const{s:t,d:r}=e;let i=I.get(r);i||(i=[new Set],I.set(e.d,i)),i[0].add(e);let l=O.get(t);if(!l){const n=new Set,x=_(t,o=>{n.forEach(u=>{const{d:a,c:p,n:m,i:g}=u;t===a&&o.every(b=>b[1].length===1&&g.includes(b[1][0]))||u.p||(Q(t,p),m?D(t):u.p=Promise.resolve().then(()=>{delete u.p,D(t)}))})},!0);l=[n,x,0,new Set],O.set(t,l)}l[0].add(e)},Y=e=>{const{s:t,d:r}=e,i=I.get(r);i==null||i[0].delete(e),(i==null?void 0:i[0].size)===0&&I.delete(r);const l=O.get(t);if(l){const[n,x]=l;n.delete(e),n.size||(x(),O.delete(t))}};function Z(e,t){const r=(t==null?void 0:t.proxy)||H({}),i=!(t==null||!t.sync),l=Object.keys(e);return l.forEach(n=>{if(Object.getOwnPropertyDescriptor(r,n))throw new Error("object property already defined");const x=e[n];let o=null;const u=()=>{if(o&&(Array.from(o).map(([g])=>((b,k)=>{const j=O.get(b);return!(j==null||!j[2]||(j[3].add(k),0))})(g,u)).some(g=>g)||Array.from(o).every(([g,b])=>A(g)===b.v)))return;const a=new Map,p=x(g=>(a.set(g,{v:A(g)}),g)),m=()=>{var g;a.forEach((b,k)=>{var j;const W=(j=o)==null||(j=j.get(k))==null?void 0:j.s;if(W)b.s=W;else{const R={s:k,d:r,k:n,c:u,n:i,i:l};X(R),b.s=R}}),(g=o)==null||g.forEach((b,k)=>{!a.has(k)&&b.s&&Y(b.s)}),o=a};p instanceof Promise?p.finally(m):m(),r[n]=p};u()}),r}var f=(e=>(e.One="ONE",e.Two="TWO",e.Three="THREE",e.Four="FOUR",e))(f||{}),s=(e=>(e.Solid="SOLID",e.Stripe="STRIPE",e.Even="EVEN",e.Odd="ODD",e))(s||{}),v=(e=>(e.SolidEven="SOLID_EVEN",e.SolidOdd="SOLID_ODD",e.StripeEven="STRIPE_EVEN",e.StripeOdd="STRIPE_ODD",e))(v||{});const S=e=>e===s.Odd?"Odds":e===s.Solid?"Solids":e===s.Even?"Evens":"Stripes",K=(e,t)=>t[e]?t[e]:`Player ${e.toLowerCase()}`,ee=e=>{if(!e)return"";let t=e%10,r=e%100;return t===1&&r!==11?e+"st":t===2&&r!==12?e+"nd":t===3&&r!==13?e+"rd":e+"th"},te=(e,t)=>{const r={[s.Even]:e.filter(l=>l%2===0),[s.Odd]:e.filter(l=>l%2!==0),[s.Solid]:e.filter(l=>l<=8),[s.Stripe]:e.filter(l=>l>=9)},i=Object.values(s).reduce((l,n)=>r[n].length>0&&t.includes(n)?[...l,n]:l,[]);return i.length>0?i:t},T=e=>{const t=Object.values(e).reduce((r,i)=>r+ +(i.length===1),0);return t<4?(Object.values(f).forEach(i=>{e[i].length===1&&Object.values(f).filter(l=>l!==i).forEach(l=>{e[l]=e[l].filter(n=>n!==e[i][0])})}),Object.values(e).reduce((i,l)=>i+ +(l.length===1),0)>t?T(e):e):e},F=e=>{const t=Object.keys(e).filter(r=>e[r].length===2);return{[v.SolidEven]:t.filter(r=>[s.Solid,s.Even].every(i=>e[r].includes(i))),[v.SolidOdd]:t.filter(r=>[s.Solid,s.Odd].every(i=>e[r].includes(i))),[v.StripeEven]:t.filter(r=>[s.Stripe,s.Even].every(i=>e[r].includes(i))),[v.StripeOdd]:t.filter(r=>[s.Stripe,s.Odd].every(i=>e[r].includes(i)))}},ne=e=>{if(Object.keys(e).filter(l=>e[l].length===2).length<=1)return e;const r=F(e),i=Object.keys(r).find(l=>r[l].length>1);return i&&(Object.keys(e).filter(l=>!r[i].includes(l)).forEach(l=>{e[l]=e[l].filter(n=>!e[r[i][0]].includes(n))}),e=T(e)),e},ie=e=>{let t={...e};return t=T(t),t=ne(t),t},re=e=>{const t=Object.values(f).find(n=>e[n].length===1&&e[n].includes(s.Solid)),r=Object.values(f).find(n=>e[n].length===1&&e[n].includes(s.Stripe)),i=Object.values(f).find(n=>e[n].length===1&&e[n].includes(s.Even)),l=Object.values(f).find(n=>e[n].length===1&&e[n].includes(s.Odd));return{[s.Solid]:t,[s.Stripe]:r,[s.Even]:i,[s.Odd]:l}},N=(e,t,r)=>{let i=!1;return Object.values(s).forEach(l=>{if(r[l]===e)switch(l){case s.Solid:i=Object.entries(t).filter(([n])=>Number(n)<9).every(([,n])=>n==="sunk"||n==="queued");break;case s.Stripe:i=Object.entries(t).filter(([n])=>Number(n)>8).every(([,n])=>n==="sunk"||n==="queued");break;case s.Even:i=Object.entries(t).filter(([n])=>Number(n)%2===0).every(([,n])=>n==="sunk"||n==="queued");break;case s.Odd:i=Object.entries(t).filter(([n])=>Number(n)%2!==0).every(([,n])=>n==="sunk"||n==="queued");break}}),i},se=h.div.withConfig({displayName:"Wrapper",componentId:"sc-pvlmyp-0"})(["position:relative;flex:1;"]),oe=h.div.withConfig({displayName:"GraphLabels",componentId:"sc-pvlmyp-1"})(["display:grid;grid-template:auto 1fr 1fr / auto 1fr 1fr;grid-template-areas:'. "," ","' '"," g g' '"," g g';"],s.Solid,s.Stripe,s.Even,s.Odd),le=h.div.withConfig({displayName:"GraphBody",componentId:"sc-pvlmyp-2"})(["position:relative;grid-area:g;background-color:",";display:grid;grid-template:1fr 1fr / 1fr 1fr;"],({theme:e})=>e.backgroundHighlight),y=h.div.withConfig({displayName:"GridHeader",componentId:"sc-pvlmyp-3"})(["display:flex;align-items:center;justify-content:center;grid-area:",";padding:1rem;text-align:center;font-size:1.4rem;","{font-size:1rem;}",""],({$ballType:e})=>e,q,({$ballType:e})=>(e===s.Even||e===s.Odd)&&w(["writing-mode:vertical-lr;transform:scale(-1,-1);padding-block-end:0;"])),C=h.div.withConfig({displayName:"GridCell",componentId:"sc-pvlmyp-4"})(["width:100%;display:flex;align-items:center;justify-content:center;text-align:center;font-size:1.4rem;border:1px solid ",";&::after{content:'';display:block;padding-bottom:100%;}"],({theme:e})=>e.secondary),de=h.div.withConfig({displayName:"Label",componentId:"sc-pvlmyp-5"})(["position:absolute;width:50%;height:50%;top:",";left:",";display:flex;align-items:center;justify-content:center;transition-property:top,left;transition-duration:1s;transition-timing-function:ease-in-out;> span{padding:1rem;max-width:calc(100% - 2px);background-color:",";text-align:center;font-size:1.8rem;"," ","{font-size:1.2rem;}}",""],({$location:e,$index:t})=>e===s.Solid||e===s.Stripe||e==="hidden"?"25%":e===s.Odd?"50%":e===s.Even?"0":e===v.SolidEven||e===v.StripeEven?t===0?"-12.5%":t===1?"12.5%":"0":t===0?"37.5%":t===1?"62.5%":"50%",({$location:e})=>e===s.Even||e===s.Odd||e==="hidden"?"25%":e===v.StripeEven||e===v.StripeOdd||e===s.Stripe?"50%":"0",({theme:e})=>e.backgroundHighlight,({$rank:e,theme:t})=>e!==void 0&&w(["color:",";"],M((e-1)/3,t.danger,t.primary)),q,({$location:e})=>e==="hidden"&&w(["display:none;"])),ae=(e,t,r)=>{const i=Object.values(s).find(n=>t[n]===e);if(i)return i;const l=Object.values(v).find(n=>r[n].includes(e));return l||"hidden"},ce=(e,t)=>{const r=Object.keys(t).find(i=>t[i].includes(e));return!r||t[r].length===1?-1:t[r][0]===e?0:1},ue=({game:e,decided:t})=>{const r=P.useMemo(()=>F(e.roles),[e.roles]);return d.jsx(se,{children:d.jsxs(oe,{children:[d.jsx("div",{}),d.jsx(y,{$ballType:s.Solid,children:S(s.Solid)}),d.jsx(y,{$ballType:s.Stripe,children:S(s.Stripe)}),d.jsx(y,{$ballType:s.Even,children:S(s.Even)}),d.jsx(y,{$ballType:s.Odd,children:S(s.Odd)}),d.jsxs(le,{children:[d.jsx(C,{children:Object.values(f).map(i=>d.jsx(de,{$location:ae(i,t,r),$index:ce(i,r),$rank:e.rankings[i],children:d.jsxs("span",{children:[K(i,e.names),e.rankings[i]&&d.jsxs("span",{children:[" - ",ee(e.rankings[i])]})]})},`${v.SolidEven}-${i}`))}),d.jsx(C,{}),d.jsx(C,{}),d.jsx(C,{})]})]})})},z={names:{[f.One]:"",[f.Two]:"",[f.Three]:"",[f.Four]:""},balls:{1:"table",2:"table",3:"table",4:"table",5:"table",6:"table",7:"table",8:"table",9:"table",10:"table",11:"table",12:"table",13:"table",14:"table",15:"table"},roles:{[f.One]:Object.values(s),[f.Two]:Object.values(s),[f.Three]:Object.values(s),[f.Four]:Object.values(s)},shots:[],rankings:{}},c=V({name:"sseo",initialState:z,version:0,migrations:{},...U}),fe=Z({decided:e=>re(e(c).roles)}),pe=h.div.withConfig({displayName:"Wrapper",componentId:"sc-geon8w-0"})(["margin:0 auto;width:100%;padding:1rem 3rem;display:flex;flex-wrap:wrap;justify-content:space-between;gap:2rem;","{flex-direction:column;align-items:center;padding:1rem;}color:",";"],q,({theme:e})=>e.text),ge=h.div.withConfig({displayName:"LeftSection",componentId:"sc-geon8w-1"})(["flex:1;display:flex;flex-direction:column;gap:2rem;> button{align-self:flex-start;}"]),he=h.div.withConfig({displayName:"RightSection",componentId:"sc-geon8w-2"})(["flex:1;width:100%;"]),be=["#F6DD4A","#0E348A","#B2342B","#381F74","#E77943","#2F6A50","#611915","#000000"],me=h.header.withConfig({displayName:"Header",componentId:"sc-geon8w-3"})(["display:flex;gap:1rem;align-items:center;font-size:1.2rem;"]),ve=h.div.withConfig({displayName:"PlayerWrapper",componentId:"sc-geon8w-4"})(["display:flex;gap:1rem;flex-wrap:wrap;align-items:flex-end;font-size:1.2rem;> div{display:flex;flex-direction:column;gap:0.5rem;text-indent:1rem;> div{display:flex;gap:1rem;align-items:center;text-indent:0;> label{width:19rem;}}}"]),$=h.div.withConfig({displayName:"BallsWrapper",componentId:"sc-geon8w-5"})(["display:flex;gap:1rem;flex-wrap:wrap;font-size:1.2rem;"]),L=h.div.withConfig({displayName:"PoolBall",componentId:"sc-geon8w-6"})(["position:relative;width:2em;height:2em;border-radius:50%;background-color:",";box-sizing:border-box;"," display:flex;place-content:center;align-items:center;overflow:hidden;user-select:none;"," ::after{content:'';position:absolute;box-sizing:border-box;top:0;width:2em;aspect-ratio:1;border-radius:50%;border:1px solid black;}> div{width:50%;aspect-ratio:1;border-radius:50%;background-color:white;color:black;font-size:0.6em;border:1px solid black;display:flex;place-content:center;align-items:center;}"],({$num:e})=>be[(e-1)%8],({$isSunk:e})=>!e&&w(["cursor:pointer;"]),({$num:e})=>e>8&&w(["::before{content:'';box-sizing:border-box;position:absolute;top:15%;width:100%;height:70%;border-top:1px solid black;border-bottom:1px solid black;box-shadow:0 0 0 1rem white;}"])),xe=h.div.withConfig({displayName:"ConfirmQueue",componentId:"sc-geon8w-7"})(["display:flex;gap:1rem;flex-wrap:wrap;align-items:center;font-size:1.2rem;> select{padding:0.75rem 0.5rem;border:1px solid ",";border-radius:0.25rem;outline:none;color:",";background-color:",";&:focus{border-color:",";}}"],({theme:e})=>e.focus,({theme:e})=>e.text,({theme:e})=>e.background,({theme:e})=>e.secondary),Oe=()=>{const e=J(),[t,r]=P.useState(f.One),[i,l]=P.useState(!1),n=B(c),{decided:x}=B(fe);return d.jsxs(pe,{children:[d.jsxs(ge,{children:[d.jsxs(me,{children:[d.jsx("h1",{children:"Solids vs Stripes vs Evens vs Odds "}),d.jsx(E,{onClick:()=>{Object.assign(c.balls,z.balls),Object.assign(c.roles,z.roles),c.shots=[],c.rankings={},r(f.One)},color:e.focus,children:"New game"})]}),Object.values(f).map((o,u)=>d.jsxs(ve,{children:[d.jsxs("div",{children:[`Player ${o.toLowerCase()} - ${n.roles[o].map(a=>S(a)).join(" | ")}`,d.jsxs("div",{children:[d.jsx(G,{placeholder:"Player name",type:"text",value:n.names[o],onChange:a=>{c.names[o]=a.target.value}}),d.jsx(E,{color:e.primary,$variant:"outline",onClick:()=>r(o),disabled:n.rankings[o]!==void 0,children:"Select"})]})]}),n.shots.filter(({player:a})=>a===o).map(({balls:a})=>a.map(p=>d.jsx(L,{$num:p,$isSunk:!0,children:d.jsx("div",{children:p})},`ball-${p}`)))]},o)),d.jsx("div",{children:"Remaining - click a ball to queue"}),d.jsx($,{children:Object.entries(n.balls).filter(([,o])=>o==="table").map(([o])=>{const u=+o;return d.jsx(L,{title:"Click to add to queue",$num:u,onClick:()=>{c.balls[u]="queued"},children:d.jsx("div",{children:o})},`ball-${o}`)})}),d.jsxs(xe,{children:[d.jsx("div",{children:"Queue"}),d.jsx("select",{title:"Select Player",value:t,onChange:o=>r(o.target.value),children:Object.values(f).map((o,u)=>d.jsx("option",{label:n.names[o]||`Player ${u+1}`,value:o,disabled:n.rankings[o]!==void 0},o))}),d.jsx(E,{$variant:"outline",color:e.focus,disabled:!Object.values(n.balls).some(o=>o==="queued"),onClick:()=>{const o=Object.entries(n.balls).filter(([,a])=>a==="queued").map(([a])=>Number(a));c.shots.push({player:t,balls:o,roles:n.roles,rankings:n.rankings,lost:i}),o.forEach(a=>{c.balls[a]="sunk"}),c.roles=ie({...n.roles,[t]:te(o,n.roles[t])});let u=!1;if(N(t,c.balls,x)){u=!0;let a=[1,2,3,4];Object.values(c.rankings).forEach(p=>a=a.filter(m=>m!==p)),i?c.rankings[t]=a.at(-1):c.rankings[t]=a.at(0),r(p=>Object.values(f).find(m=>typeof c.rankings[m]>"u"&&m!==t)??p)}Object.values(f).forEach(a=>{if(typeof c.rankings[a]>"u"&&(!u||a!==t)&&N(a,c.balls,x)){let p=[1,2,3,4];Object.values(c.rankings).forEach(m=>p=p.filter(g=>g!==m)),c.rankings[a]=p.at(0)}}),l(!1)},children:"Confirm"})]}),Object.entries(n.balls).filter(([,o])=>o==="queued").length>0&&d.jsxs($,{children:[Object.entries(n.balls).filter(([,o])=>o==="queued").map(([o])=>{const u=Number(o);return d.jsx(L,{title:"Click to remove from queue",$num:u,onClick:()=>{c.balls[u]="table"},children:d.jsx("div",{children:o})},`ball-${o}`)}),N(t,n.balls,x)&&d.jsx(G,{type:"checkbox",label:"called wrong pocket / scratched",checked:i,onChange:o=>l(o.target.checked)})]}),n.shots.length>0&&d.jsx(E,{$variant:"outline",color:e.danger,onClick:()=>{const o=n.shots.at(-1);o&&(Object.entries(c.balls).forEach(([u,a])=>{a==="queued"&&(c.balls[Number(u)]="table")}),o.balls.forEach(u=>c.balls[u]="queued"),Object.assign(c.roles,o.roles),c.rankings={},Object.assign(c.rankings,o.rankings),l(o.lost),r(o.player),c.shots.pop())},children:"Undo Last Shot"})]}),d.jsx(he,{children:d.jsx(ue,{game:n,decided:x})})]})};export{Oe as default};
