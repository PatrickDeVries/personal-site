import{l as V,m as G,s as Z,i as O,a as p,j as a,e as Q,n as X,T as W,o as J,r as z,q as Y,t as K,f as _}from"./index-y14O8Wta.js";import{B as y}from"./style-hl--SHMX.js";const k=new WeakMap,T=new WeakMap,M=(e,t)=>{const i=k.get(e);i&&(i[0].forEach(r=>{const{d:l}=r;e!==l&&M(l)}),++i[2],t&&i[3].add(t))},D=e=>{const t=k.get(e);t&&(--t[2],t[2]||(t[3].forEach(i=>i()),t[3].clear()),t[0].forEach(i=>{const{d:r}=i;e!==r&&D(r)}))},ee=e=>{const{s:t,d:i}=e;let r=T.get(i);r||(r=[new Set],T.set(e.d,r)),r[0].add(e);let l=k.get(t);if(!l){const n=new Set,x=Z(t,o=>{n.forEach(u=>{const{d,c:g,n:m,i:b}=u;t===d&&o.every(h=>h[1].length===1&&b.includes(h[1][0]))||u.p||(M(t,g),m?D(t):u.p=Promise.resolve().then(()=>{delete u.p,D(t)}))})},!0);l=[n,x,0,new Set],k.set(t,l)}l[0].add(e)},te=e=>{const{s:t,d:i}=e,r=T.get(i);r==null||r[0].delete(e),(r==null?void 0:r[0].size)===0&&T.delete(i);const l=k.get(t);if(l){const[n,x]=l;n.delete(e),n.size||(x(),k.delete(t))}};function ne(e,t){const i=(t==null?void 0:t.proxy)||V({}),r=!(t==null||!t.sync),l=Object.keys(e);return l.forEach(n=>{if(Object.getOwnPropertyDescriptor(i,n))throw new Error("object property already defined");const x=e[n];let o=null;const u=()=>{if(o&&(Array.from(o).map(([b])=>((h,w)=>{const j=k.get(h);return!(j==null||!j[2]||(j[3].add(w),0))})(b,u)).some(b=>b)||Array.from(o).every(([b,h])=>G(b)===h.v)))return;const d=new Map,g=x(b=>(d.set(b,{v:G(b)}),b)),m=()=>{var b;d.forEach((h,w)=>{var j;const H=(j=o)==null||(j=j.get(w))==null?void 0:j.s;if(H)h.s=H;else{const A={s:w,d:i,k:n,c:u,n:r,i:l};ee(A),h.s=A}}),(b=o)==null||b.forEach((h,w)=>{!d.has(w)&&h.s&&te(h.s)}),o=d};g instanceof Promise?g.finally(m):m(),i[n]=g};u()}),i}const E="0.1em",re=O(["appearance:none;padding:0.5em 0.75em;font:inherit;box-sizing:border-box;background-color:",";border-radius:calc(1em / 3);border:"," solid ",";outline:none;color:",";&:focus-within{border-color:",";}"],({variant:e,color:t,theme:i})=>e==="fill"?t:i.backgroundHighlight,({variant:e})=>e==="outline"?E:"0",({color:e})=>e,({theme:e})=>e.text,({theme:e})=>e.focus),ie=p.label.withConfig({displayName:"TextLabel",componentId:"sc-1tkz4fl-0"})(["display:flex;flex-direction:column;gap:0.5em;text-indent:calc("," + 0.75em);"],E),se=p.label.withConfig({displayName:"ToggleLabel",componentId:"sc-8t48mv-0"})(["display:flex;gap:1em;align-items:center;user-select:none;"," input{cursor:inherit;}"],({disabled:e})=>!e&&O(["cursor:pointer;"])),B=O(["position:absolute;bottom:10%;left:30%;transform-origin:top left;"]),C=220,oe=p.input.withConfig({displayName:"CheckboxInput",componentId:"sc-8t48mv-1"})(["appearance:none;margin:0;position:relative;box-sizing:border-box;font:inherit;width:1em;aspect-ratio:1;border:"," solid ",";background-color:",";&::before{content:'';"," width:0.2em;height:",";transform:scale(0) rotateZ(","deg);background-color:",";}&::after{content:'';"," width:0.65em;height:",";transform:scale(0) rotateZ(","deg);background-color:",";}&:checked{&::before{transform:scale(1) rotateZ(","deg);}&::after{transform:scale(1) rotateZ(","deg);}border-color:",";}"],E,({theme:e})=>e.text,({theme:e})=>e.backgroundHighlight,B,E,C,({theme:e})=>e.secondary,B,E,C+90,({theme:e})=>e.secondary,C,C+90,({theme:e})=>e.secondary),le=({disabled:e,...t})=>a.jsxs(se,{disabled:e,children:[a.jsx(oe,{disabled:e,...t}),t.label??""]}),ae=p.input.withConfig({displayName:"TextInput",componentId:"sc-yf0rpv-0"})(["",""],re),de=({variant:e="outline",color:t,...i})=>{const r=Q();return t??(t=e==="outline"?r.secondary:r.background),a.jsxs(ie,{children:[i.label??"",a.jsx(ae,{variant:e,color:t,...i})]})},ce={checkbox:le,text:de},$=({type:e,...t})=>X.createElement(ce[e],{type:e,...t});var f=(e=>(e.One="ONE",e.Two="TWO",e.Three="THREE",e.Four="FOUR",e))(f||{}),s=(e=>(e.Solid="SOLID",e.Stripe="STRIPE",e.Even="EVEN",e.Odd="ODD",e))(s||{}),v=(e=>(e.SolidEven="SOLID_EVEN",e.SolidOdd="SOLID_ODD",e.StripeEven="STRIPE_EVEN",e.StripeOdd="STRIPE_ODD",e))(v||{});const S=e=>e===s.Odd?"Odds":e===s.Solid?"Solids":e===s.Even?"Evens":"Stripes",ue=(e,t)=>t[e]?t[e]:`Player ${e.toLowerCase()}`,fe=e=>{if(!e)return"";let t=e%10,i=e%100;return t===1&&i!==11?e+"st":t===2&&i!==12?e+"nd":t===3&&i!==13?e+"rd":e+"th"},pe=(e,t)=>{const i={[s.Even]:e.filter(l=>l%2===0),[s.Odd]:e.filter(l=>l%2!==0),[s.Solid]:e.filter(l=>l<=8),[s.Stripe]:e.filter(l=>l>=9)},r=Object.values(s).reduce((l,n)=>i[n].length>0&&t.includes(n)?[...l,n]:l,[]);return r.length>0?r:t},R=e=>{const t=Object.values(e).reduce((i,r)=>i+ +(r.length===1),0);return t<4?(Object.values(f).forEach(r=>{e[r].length===1&&Object.values(f).filter(l=>l!==r).forEach(l=>{e[l]=e[l].filter(n=>n!==e[r][0])})}),Object.values(e).reduce((r,l)=>r+ +(l.length===1),0)>t?R(e):e):e},U=e=>{const t=Object.keys(e).filter(i=>e[i].length===2);return{[v.SolidEven]:t.filter(i=>[s.Solid,s.Even].every(r=>e[i].includes(r))),[v.SolidOdd]:t.filter(i=>[s.Solid,s.Odd].every(r=>e[i].includes(r))),[v.StripeEven]:t.filter(i=>[s.Stripe,s.Even].every(r=>e[i].includes(r))),[v.StripeOdd]:t.filter(i=>[s.Stripe,s.Odd].every(r=>e[i].includes(r)))}},ge=e=>{if(Object.keys(e).filter(l=>e[l].length===2).length<=1)return e;const i=U(e),r=Object.keys(i).find(l=>i[l].length>1);return r&&(Object.keys(e).filter(l=>!i[r].includes(l)).forEach(l=>{e[l]=e[l].filter(n=>!e[i[r][0]].includes(n))}),e=R(e)),e},be=e=>{let t={...e};return t=R(t),t=ge(t),t},he=e=>{const t=Object.values(f).find(n=>e[n].length===1&&e[n].includes(s.Solid)),i=Object.values(f).find(n=>e[n].length===1&&e[n].includes(s.Stripe)),r=Object.values(f).find(n=>e[n].length===1&&e[n].includes(s.Even)),l=Object.values(f).find(n=>e[n].length===1&&e[n].includes(s.Odd));return{[s.Solid]:t,[s.Stripe]:i,[s.Even]:r,[s.Odd]:l}},L=(e,t,i)=>{let r=!1;return Object.values(s).forEach(l=>{if(i[l]===e)switch(l){case s.Solid:r=Object.entries(t).filter(([n])=>Number(n)<9).every(([,n])=>n==="sunk"||n==="queued");break;case s.Stripe:r=Object.entries(t).filter(([n])=>Number(n)>8).every(([,n])=>n==="sunk"||n==="queued");break;case s.Even:r=Object.entries(t).filter(([n])=>Number(n)%2===0).every(([,n])=>n==="sunk"||n==="queued");break;case s.Odd:r=Object.entries(t).filter(([n])=>Number(n)%2!==0).every(([,n])=>n==="sunk"||n==="queued");break}}),r},me=p.div.withConfig({displayName:"Wrapper",componentId:"sc-pvlmyp-0"})(["position:relative;flex:1;"]),ve=p.div.withConfig({displayName:"GraphLabels",componentId:"sc-pvlmyp-1"})(["display:grid;grid-template:auto 1fr 1fr / auto 1fr 1fr;grid-template-areas:'. "," ","' '"," g g' '"," g g';"],s.Solid,s.Stripe,s.Even,s.Odd),xe=p.div.withConfig({displayName:"GraphBody",componentId:"sc-pvlmyp-2"})(["position:relative;grid-area:g;background-color:",";display:grid;grid-template:1fr 1fr / 1fr 1fr;"],({theme:e})=>e.backgroundHighlight),I=p.div.withConfig({displayName:"GridHeader",componentId:"sc-pvlmyp-3"})(["display:flex;align-items:center;justify-content:center;grid-area:",";padding:1rem;text-align:center;font-size:1.4rem;","{font-size:1rem;}",""],({$ballType:e})=>e,W,({$ballType:e})=>(e===s.Even||e===s.Odd)&&O(["writing-mode:vertical-lr;transform:scale(-1,-1);padding-block-end:0;"])),N=p.div.withConfig({displayName:"GridCell",componentId:"sc-pvlmyp-4"})(["width:100%;display:flex;align-items:center;justify-content:center;text-align:center;font-size:1.4rem;border:1px solid ",";&::after{content:'';display:block;padding-bottom:100%;}"],({theme:e})=>e.secondary),je=p.div.withConfig({displayName:"Label",componentId:"sc-pvlmyp-5"})(["position:absolute;width:50%;height:50%;top:",";left:",";display:flex;align-items:center;justify-content:center;transition-property:top,left;transition-duration:1s;transition-timing-function:ease-in-out;> span{padding:1rem;max-width:calc(100% - 2px);background-color:",";text-align:center;font-size:1.8rem;"," ","{font-size:1.2rem;}}",""],({$location:e,$index:t})=>e===s.Solid||e===s.Stripe||e==="hidden"?"25%":e===s.Odd?"50%":e===s.Even?"0":e===v.SolidEven||e===v.StripeEven?t===0?"-12.5%":t===1?"12.5%":"0":t===0?"37.5%":t===1?"62.5%":"50%",({$location:e})=>e===s.Even||e===s.Odd||e==="hidden"?"25%":e===v.StripeEven||e===v.StripeOdd||e===s.Stripe?"50%":"0",({theme:e})=>e.backgroundHighlight,({$rank:e,theme:t})=>e!==void 0&&O(["color:",";"],J((e-1)/3,t.danger,t.primary)),W,({$location:e})=>e==="hidden"&&O(["display:none;"])),Oe=(e,t,i)=>{const r=Object.values(s).find(n=>t[n]===e);if(r)return r;const l=Object.values(v).find(n=>i[n].includes(e));return l||"hidden"},ke=(e,t)=>{const i=Object.keys(t).find(r=>t[r].includes(e));return!i||t[i].length===1?-1:t[i][0]===e?0:1},we=({game:e,decided:t})=>{const i=z.useMemo(()=>U(e.roles),[e.roles]);return a.jsx(me,{children:a.jsxs(ve,{children:[a.jsx("div",{}),a.jsx(I,{$ballType:s.Solid,children:S(s.Solid)}),a.jsx(I,{$ballType:s.Stripe,children:S(s.Stripe)}),a.jsx(I,{$ballType:s.Even,children:S(s.Even)}),a.jsx(I,{$ballType:s.Odd,children:S(s.Odd)}),a.jsxs(xe,{children:[a.jsx(N,{children:Object.values(f).map(r=>a.jsx(je,{$location:Oe(r,t,i),$index:ke(r,i),$rank:e.rankings[r],children:a.jsxs("span",{children:[ue(r,e.names),e.rankings[r]&&a.jsxs("span",{children:[" - ",fe(e.rankings[r])]})]})},`${v.SolidEven}-${r}`))}),a.jsx(N,{}),a.jsx(N,{}),a.jsx(N,{})]})]})})},q={names:{[f.One]:"",[f.Two]:"",[f.Three]:"",[f.Four]:""},balls:{1:"table",2:"table",3:"table",4:"table",5:"table",6:"table",7:"table",8:"table",9:"table",10:"table",11:"table",12:"table",13:"table",14:"table",15:"table"},roles:{[f.One]:Object.values(s),[f.Two]:Object.values(s),[f.Three]:Object.values(s),[f.Four]:Object.values(s)},shots:[],rankings:{}},c=Y({name:"sseo",initialState:q,version:0,migrations:{},...K}),Se=ne({decided:e=>he(e(c).roles)}),Ee=p.div.withConfig({displayName:"Wrapper",componentId:"sc-geon8w-0"})(["margin:0 auto;width:100%;padding:1rem 3rem;display:flex;flex-wrap:wrap;justify-content:space-between;gap:2rem;","{flex-direction:column;align-items:center;padding:1rem;}color:",";"],W,({theme:e})=>e.text),ye=p.div.withConfig({displayName:"LeftSection",componentId:"sc-geon8w-1"})(["flex:1;display:flex;flex-direction:column;gap:2rem;> button{align-self:flex-start;}"]),Ce=p.div.withConfig({displayName:"RightSection",componentId:"sc-geon8w-2"})(["flex:1;width:100%;"]),Ie=["#F6DD4A","#0E348A","#B2342B","#381F74","#E77943","#2F6A50","#611915","#000000"],Ne=p.header.withConfig({displayName:"Header",componentId:"sc-geon8w-3"})(["display:flex;gap:1rem;align-items:center;font-size:1.2rem;"]),Te=p.div.withConfig({displayName:"PlayerWrapper",componentId:"sc-geon8w-4"})(["display:flex;gap:1rem;flex-wrap:wrap;align-items:flex-end;font-size:1.2rem;> div{display:flex;flex-direction:column;gap:0.5rem;text-indent:1rem;> div{display:flex;gap:1rem;align-items:center;text-indent:0;> label{width:19rem;}}}"]),F=p.div.withConfig({displayName:"BallsWrapper",componentId:"sc-geon8w-5"})(["display:flex;gap:1rem;flex-wrap:wrap;font-size:1.2rem;"]),P=p.div.withConfig({displayName:"PoolBall",componentId:"sc-geon8w-6"})(["position:relative;width:2em;height:2em;border-radius:50%;background-color:",";box-sizing:border-box;"," display:flex;place-content:center;align-items:center;overflow:hidden;user-select:none;"," ::after{content:'';position:absolute;box-sizing:border-box;top:0;width:2em;aspect-ratio:1;border-radius:50%;border:1px solid black;}> div{width:50%;aspect-ratio:1;border-radius:50%;background-color:white;color:black;font-size:0.6em;border:1px solid black;display:flex;place-content:center;align-items:center;}"],({$num:e})=>Ie[(e-1)%8],({$isSunk:e})=>!e&&O(["cursor:pointer;"]),({$num:e})=>e>8&&O(["::before{content:'';box-sizing:border-box;position:absolute;top:15%;width:100%;height:70%;border-top:1px solid black;border-bottom:1px solid black;box-shadow:0 0 0 1rem white;}"])),Le=p.div.withConfig({displayName:"ConfirmQueue",componentId:"sc-geon8w-7"})(["display:flex;gap:1rem;flex-wrap:wrap;align-items:center;font-size:1.2rem;> select{padding:0.75rem 0.5rem;border:1px solid ",";border-radius:0.25rem;outline:none;color:",";background-color:",";&:focus{border-color:",";}}"],({theme:e})=>e.focus,({theme:e})=>e.text,({theme:e})=>e.background,({theme:e})=>e.secondary),De=()=>{const e=Q(),[t,i]=z.useState(f.One),[r,l]=z.useState(!1),n=_(c),{decided:x}=_(Se);return a.jsxs(Ee,{children:[a.jsxs(ye,{children:[a.jsxs(Ne,{children:[a.jsx("h1",{children:"Solids vs Stripes vs Evens vs Odds "}),a.jsx(y,{onClick:()=>{Object.assign(c.balls,q.balls),Object.assign(c.roles,q.roles),c.shots=[],c.rankings={},i(f.One)},color:e.focus,children:"New game"})]}),Object.values(f).map((o,u)=>a.jsxs(Te,{children:[a.jsxs("div",{children:[`Player ${o.toLowerCase()} - ${n.roles[o].map(d=>S(d)).join(" | ")}`,a.jsxs("div",{children:[a.jsx($,{placeholder:"Player name",type:"text",value:n.names[o],onChange:d=>{c.names[o]=d.target.value}}),a.jsx(y,{color:e.primary,$variant:"outline",onClick:()=>i(o),disabled:n.rankings[o]!==void 0,children:"Select"})]})]}),n.shots.filter(({player:d})=>d===o).map(({balls:d})=>d.map(g=>a.jsx(P,{$num:g,$isSunk:!0,children:a.jsx("div",{children:g})},`ball-${g}`)))]},o)),a.jsx("div",{children:"Remaining - click a ball to queue"}),a.jsx(F,{children:Object.entries(n.balls).filter(([,o])=>o==="table").map(([o])=>{const u=+o;return a.jsx(P,{title:"Click to add to queue",$num:u,onClick:()=>{c.balls[u]="queued"},children:a.jsx("div",{children:o})},`ball-${o}`)})}),a.jsxs(Le,{children:[a.jsx("div",{children:"Queue"}),a.jsx("select",{title:"Select Player",value:t,onChange:o=>i(o.target.value),children:Object.values(f).map((o,u)=>a.jsx("option",{label:n.names[o]||`Player ${u+1}`,value:o,disabled:n.rankings[o]!==void 0},o))}),a.jsx(y,{$variant:"outline",color:e.focus,disabled:!Object.values(n.balls).some(o=>o==="queued"),onClick:()=>{const o=Object.entries(n.balls).filter(([,d])=>d==="queued").map(([d])=>Number(d));c.shots.push({player:t,balls:o,roles:n.roles,rankings:n.rankings,lost:r}),o.forEach(d=>{c.balls[d]="sunk"}),c.roles=be({...n.roles,[t]:pe(o,n.roles[t])});let u=!1;if(L(t,c.balls,x)){u=!0;let d=[1,2,3,4];Object.values(c.rankings).forEach(g=>d=d.filter(m=>m!==g)),r?c.rankings[t]=d.at(-1):c.rankings[t]=d.at(0),i(g=>Object.values(f).find(m=>typeof c.rankings[m]>"u"&&m!==t)??g)}Object.values(f).forEach(d=>{if(typeof c.rankings[d]>"u"&&(!u||d!==t)&&L(d,c.balls,x)){let g=[1,2,3,4];Object.values(c.rankings).forEach(m=>g=g.filter(b=>b!==m)),c.rankings[d]=g.at(0)}}),l(!1)},children:"Confirm"})]}),Object.entries(n.balls).filter(([,o])=>o==="queued").length>0&&a.jsxs(F,{children:[Object.entries(n.balls).filter(([,o])=>o==="queued").map(([o])=>{const u=Number(o);return a.jsx(P,{title:"Click to remove from queue",$num:u,onClick:()=>{c.balls[u]="table"},children:a.jsx("div",{children:o})},`ball-${o}`)}),L(t,n.balls,x)&&a.jsx($,{type:"checkbox",label:"called wrong pocket / scratched",checked:r,onChange:o=>l(o.target.checked)})]}),n.shots.length>0&&a.jsx(y,{$variant:"outline",color:e.danger,onClick:()=>{const o=n.shots.at(-1);o&&(Object.entries(c.balls).forEach(([u,d])=>{d==="queued"&&(c.balls[Number(u)]="table")}),o.balls.forEach(u=>c.balls[u]="queued"),Object.assign(c.roles,o.roles),c.rankings={},Object.assign(c.rankings,o.rankings),l(o.lost),i(o.player),c.shots.pop())},children:"Undo Last Shot"})]}),a.jsx(Ce,{children:a.jsx(we,{game:n,decided:x})})]})};export{De as default};
